{"code":"!function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,\"a\",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p=\"\",r(r.s=0)}([function(t,e){new class{constructor(t){Object.assign(this,t)}start(){this.init(),this.registEvent(),this.scheduler=t=>setTimeout(t,600),this.timer=this.scheduler(this.startRender.bind(this))}startRender(){this.isOver||(this.render(this.DIR),this.timer=this.scheduler(this.startRender.bind(this)))}render(t){if(\"ArrowUp\"===this.DIR&&\"ArrowDown\"===t)return;if(\"ArrowDown\"===this.DIR&&\"ArrowUp\"===t)return;if(\"ArrowLeft\"===this.DIR&&\"ArrowRight\"===t)return;if(\"ArrowRight\"===this.DIR&&\"ArrowLeft\"===t)return;const e=this.SNAKE[0];if(!this.checkBoundary(t,e))return void this.over();const r=[e[0],e[1]],i=this.SNAKE[this.SNAKE.length-1],s=[i[0],i[1]];switch(this.DIR!==t&&(this.DIR=t),t){case\"ArrowUp\":--r[1];break;case\"ArrowDown\":++r[1];break;case\"ArrowLeft\":--r[0];break;case\"ArrowRight\":++r[0];break;default:return}this.clearCanvas(),this.renderFoot();for(let t=this.SNAKE.length-1;t>0;t--)this.SNAKE[t]=this.SNAKE[t-1];this.SNAKE[0]=r,this.eatFood(s),this.renderSnake()}clearCanvas(){this.ctx.clearRect(0,0,this.WIDTH,this.HEIHGT)}eatFood(t){if(!this.food)return;const[e,r]=this.food,[i,s]=this.SNAKE[0];if(i!==e||s!==r)return;const n=this.SNAKE.length;for(let t=0;t<n-1;t++)this.SNAKE[t]=this.SNAKE[t+1];this.SNAKE[n-1]=t,this.SNAKE.unshift([e,r]);const[o,h]=this.getRenderPoint(this.food);this.food=null,this.ctx.clearRect(o,h,this.SIZE,this.SIZE),this.renderFoot(),this.score=(this.score||0)+10,console.clear(),console.log(\"分数：\",this.score)}getRenderPoint(t){const[e,r]=t;return[e*this.SIZE+(e+1)*this.GAP,r*this.SIZE+(r+1)*this.GAP]}registEvent(){this.event=t=>this.render(t.key),window.addEventListener(\"keydown\",this.event)}over(){window.removeEventListener(\"keydown\",this.event),this.isOver=!0,clearTimeout(this.timer),alert(\"游戏结束，分数：\"+(this.score||0))}renderFoot(){this.food||this.createFood();const[t,e]=this.getRenderPoint(this.food);this.ctx.fillStyle=\"white\",this.ctx.fillRect(t,e,this.SIZE,this.SIZE)}createFood(){const t=~~(Math.random()*this.COL),e=~~(Math.random()*this.ROW);return this.SNAKE.some(r=>t===r[0]&&e===r[1])&&this.createFood(),this.food=[t,e]}checkBoundary(t,e){const[r,i]=e;switch(t){case\"ArrowUp\":return i>0;case\"ArrowLeft\":return r>0;case\"ArrowDown\":return i<this.ROW-1;case\"ArrowRight\":return r<this.COL-1}return!0}renderSnake(){for(let t=0,e=this.SNAKE.length;t<e;t++){const r=this.SNAKE[t],[i,s]=r,[n,o]=this.getRenderPoint(r);if(this.ctx.fillStyle=0===t?\"orange\":\"white\",this.ctx.fillRect(n,o,this.SIZE,this.SIZE),t>=e-1)continue;const h=this.SNAKE[t+1],[c,a]=h;let d,l,u,f;s===a?(d=c>i?n+this.SIZE:n-this.GAP,l=o,u=this.GAP,f=this.SIZE):i===c&&(d=n,l=a>s?o+this.SIZE:o-this.GAP,u=this.SIZE,f=this.GAP),this.ctx.fillRect(d,l,u,f)}}init(){const t=document.getElementById(\"snake\");this.ctx=t.getContext(\"2d\");const e=this.SIZE*this.COL+this.GAP*(this.COL+1),r=this.SIZE*this.ROW+this.GAP*(this.ROW+1);t.style.backgroundColor=\"#000\",this.WIDTH=t.width=e,this.HEIHGT=t.height=r,this.food=null}}({SIZE:30,ROW:20,COL:20,GAP:5,SNAKE:[[0,0],[1,0],[2,0]],DIR:\"ArrowDown\"}).start()}]);","extractedComments":[]}